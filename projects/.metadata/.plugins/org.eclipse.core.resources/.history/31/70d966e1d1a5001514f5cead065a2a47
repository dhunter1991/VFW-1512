var imagesFolder = Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, "images");
var imageFiles = imagesFolder.getDirectoryListing();
var pWidth = Ti.Platform.displayCaps.platformWidth;
var pHeight = Ti.Platform.displayCaps.platformHeight;
var actions = [
		{title: "Now You See Me 2", description: "Sequel to the hit movie staring Jesse Eisenberg about the 4 horseman magicians. In this stunning sequel we will get to see what happens after they have completed all of their test and they are now in the secret order of magicians!",
		image: "now you see.jpg",
		actors: "Daniel Radcliffe, Lizzy Caplan, Jesse Eisenberg, Mark Ruffalo, Morgan Freeman, Woody Harrelson, Dave Franco",
		release: "Now you see me 2 is scheduled to be released to theaters on june 10, 2016!",
		director: "The director for this film is Jon M. Chu",
		budget: "The spending Budget for this film was around 200 million",
		budgetView: "55%"}, 
		{title: "Captain America, Civil War", description: "In this new super hero movie Captian america gets into some trouble and it has grave consiqunces!",
		image: "civil war.jpg",
		actors: "Chris Evans, Robert Downey Jr., Scarlett Johansson, Sebastian Stan, Anthony Mackie, Paul Bettany, Jeremy Renner, Don Cheadle, Paul Rudd",
		release: "Civil War is set to hit theaters on May 10, 2016",
		director: "Anthony Russo and Joe Russo co-directed this upcoming action film",
		budget: "The spending budget for this film was 30 million",
		budgetView: "30%"}, 
		{title: "Concussion", description: "Amazing true story about a man from Africa who traveled here looking to live in the land of the free and eventually became a doctor. However when he discovers brain damage problems related to football players he finds out that it goes deeper than he thought and must fight to prove whats right.",
		image: "concussion.jpg",
		actors: "Will Smith, Alec Baldwin, Gugu Mbatha-Raw, Arliss Howard, Paul Reiser, Luke Wilson",
		release: "Concussion will be hitting theaters everywhere this year December 25, 2015 Christmas Day!",
		director:"The director for this film was Peter Landesman",
		budget: " The spending budget for this film was around 200 million",
		budgetView: "60%"}
	];
  
var mainWindow = Titanium.UI.createWindow({
	backgroundColor: "#000",
	title: "New Movie Details",
	textAllign: "center"
});

var navWindow = Ti.UI.iOS.createNavigationWindow({
	window: mainWindow
});

var imageView = Ti.UI.createView({
	top: 0,
	height: 100,
	backgroundColor: "#0fb213",
});

var imageText = Ti.UI.createLabel({
	text: "Gallery",
	left: 20,
	color: "#fff",
	font: {fontSize: 40, fontFamily: "Cochin", fontWeight: "regular", fontStyle: "bold", }
});

var dataView = Ti.UI.createView({
	top: imageView.top+ imageView.height,
	height: 100,
	backgroundColor: "#9b05c1"
});

var dataText = Ti.UI.createLabel({
	text: "Details",
	left: 20,
	color: "#fff",
	font: {fontSize: 40, fontFamily: "Cochin", fontWeight: "regular", fontStyle: "bold", }
});

var customView = Ti.UI.createView({
	top: dataView.top+dataView.height,
	height: 100,
	backgroundColor: "#0b39be"
});

var customText =Ti.UI.createLabel({
	text: "Custom",
	left: 20,
	color: "#fff",
	font: {fontSize: 40, fontFamily: "Cochin", fontWeight: "regular", fontStyle: "bold", }
});
var termText = Ti.UI.createLabel({
	text: " VFW Term 1512 // Dylan Hunter",
	bottom: 100,
	color: "#fff",
	font: {fontSize: 12, fontFamily: "arial", fontStyle: "regular"}
});

var gallery = function(){
	var mainImageWindow = Ti.UI.createWindow({
		title: "Gallery",
		backgroundColor: "#0fb213",
	});
	var newImage = Ti.UI.createView({
		backgroundColor: "#000",
		bottom: 0,
		height: 50
	});
	var newImageText = Ti.UI.createLabel({
		text: "Display Random Image",
		left: 20,
		color: "#fff",
		font: {fontSize: 18, fontFamily: "Cochin", fontWeight: "regular", fontStyle: "regular", }
	});	
	    var i = 8;
		var randomImage = Math.floor(Math.random() * i + 1);
		var imageView = Ti.UI.createImageView({
			image: "images/" + imageFiles [randomImage],
			top: newImage.height + 20,
			bottom: 60,
			width: pWidth
		});
	var nextImage = function(){
		var randomImage = Math.floor(Math.random() * i + 1);
		imageView.image = "images/" + imageFiles [randomImage];
		if (i == i){
			imageView.image = "images/" + imageFiles [randomImage];
		};
};
	newImage.addEventListener("click", nextImage);
	mainImageWindow.add(imageView);	
	newImage.add(newImageText);
	mainImageWindow.add(newImage);
	navWindow.openWindow(mainImageWindow);
};
var data = function(){
	var dataWindow = Ti.UI.createWindow({
		title: "2015 and 2016 Upcoming Movies",
		backgroundColor: "#9b05c1",
	});
	var dataBorder = Ti.UI.createView({
		backgroundColor: "dbdbdb",
		height: 1,
	});
	var movies = Ti.UI.createTableView({
		top: dataBorder.top + dataBorder.height,
	});
	var actionSection = Ti.UI.createTableViewSection({
		headerTitle: "Action",
		footerTitle: "2015-16"
	});
	dataWindow.add(dataBorder, movies);
	navWindow.openWindow(dataWindow);
	var getDetail = function(){
		var detailWin = Ti.UI.createWindow({
			title: "2015 and 2016 Upcoming Movies",
			backgroundColor: "#9b05c1"
		});
		var detailTitleView = Ti.UI.createView({
			height:65,
			backgroundColor: "#3c7884",
			top: 0
		});
	
		var detailBorder = Ti.UI.createView({
			backgroundColor: "dbdbdb",
			height: 1,
			top: detailTitleView.height + detailTitleView.top
		});
	
		var detailTitleLabel = Ti.UI.createLabel({
			text: this.title,
			font: {fontSize: 20, fontFamily: "aerial", fontWeight: "bold"},
			top: 30,
			width: "100%",
			textAlign: "center"
		});
	
		var movieText = Ti.UI.createLabel({
			text: this.desc,
			color: "#fff",
			font: {fontsize: 14, fontFamily: "arial", fontWeight: "regular"},
			top: detailBorder.height + detailBorder.top + 300,
			left: 10,
			right: 10
		});
		var movieImage = Ti.UI.createImageView({
			image: "images/" + this.image,
			top: detailTitleView.height,
		});
		var budgetLabel = Ti.UI.createLabel({
			color: "#fff",
			text: this.budget,
			font: {fontSize: 12, fontFamily: "arial", fontWeight: "regular"},
			top: detailTitleView.height+ 230,
			textAllign: "center"
		});
		var view = Ti.UI.createView({
			backgroundColor: "#fff",
			borderRadius: 10,
			borderColor: "black",
		    top: detailTitleView.height + 260,
			left:"25%",
			right:"25%",
			height:30
		});
		var viw = Ti.UI.createView({
			backgroundColor: "#000",
			borderRadius: 10,
			borderColor: "black",
			top: detailTitleView.height + 260,
			left: "25%",
			right: this.budgetView,
			height: 30
		});
		detailTitleView.add(detailTitleLabel);
		view.add(viw);
		detailWin.add(detailTitleView, detailBorder, movieText, movieImage, view, viw, budgetLabel);
		navWindow.openWindow(detailWin);
	};
	
	for(var i=0, j = actions.length; i<j; i++){
	var theRow = Ti.UI.createTableViewRow({
		title: actions[i].title,
		desc: actions[i].description,
		image: actions[i].image,
		actors: actions[i].actors,
		budget: actions[i].budget,
		budgetView: actions[i].budgetView,
		hasChild: true
	});
	actionSection.add(theRow);
	
	theRow.addEventListener("click", getDetail);
	}
	var movieSections = [actionSection];
	movies.setData(movieSections);
};
var custom = function(){
	var customWin = Ti.UI.createWindow({
		backgroundColor: "#0b39be",
		title: "More Information",
		exitOnClose: true,
		layout: "verticle"
	});
	var textField = Ti.UI.createTextField({
 		 borderStyle: Ti.UI.INPUT_BORDERSTYLE_ROUNDED,
 		 color: '#336699',
 		 top: 40, left: 10,
 		 width: 275, height: 40
	});
	var textField2 = Ti.UI.createTextField({
 		 borderStyle: Ti.UI.INPUT_BORDERSTYLE_ROUNDED,
 		 color: '#336699',
 		 top: textField.height + textField.top + 20, left: 10,
 		 width: 275, height: 40
	});
	var textField3 = Ti.UI.createTextField({
 		 borderStyle: Ti.UI.INPUT_BORDERSTYLE_ROUNDED,
 		 color: '#336699',
 		 top: textField2.height + textField2.top + 20, left: 10,
 		 width: 275, height: 40
 	});
	var pickMovie = Ti.UI.createLabel({
		text: "Type one of the three movies from data",
		color: "#fff",
		top: 15,
		left: 10
	});
	var button = Ti.UI.createView({
		backgroundColor: "#000",
		bottom: 0,
		height: 50
	});
	var buttonLabel = Ti.UI.createLabel({
		text: "Submit",
		left: 20,
		color: "#fff",
		font: {fontSize: 18, fontFamily: "Cochin", fontWeight: "regular", fontStyle: "regular", }
	});

button.add(buttonLabel);
customWin.add(textField, textField2, textField3, button, pickMovie);
navWindow.openWindow(customWin);

	var showActors = function(){
	var dataWin = Ti.UI.createWindow({
		backgroundColor: "#0b39be",
		title: "More information About These Upcoming Films"
	});
	var text = Ti.UI.createLabel({
		//text: "movie",
		color: "#fff",
	});
	var textChange = Ti.UI.createLabel({
		//text: "movie",
		color: "#fff",
		top: 20,
		textAllign: "center"
	});
	if(actions[0].title === textField.value){
		text.text = actions[0].actors;
	}else if (actions[1].title === textField.value){
		text.text = actions[0].director;
	}else if (data[1]){
		text.text = actions[0].release;
	}else if (actions[1].title === textFeild2.value){
		text.text = actions[2].release;
	};
	
	dataWin.add(text, textChange);
	navWindow.openWindow(dataWin);
	console.log(picker.selectionIndicator);
	};
	button.addEventListener("click", showActors);
};

customView.addEventListener("click", custom);
dataView.addEventListener("click", data);
imageView.addEventListener("click", gallery);

imageView.add(imageText);
dataView.add(dataText);
customView.add(customText);
mainWindow.add(imageView, dataView, customView, termText);
navWindow.open();

